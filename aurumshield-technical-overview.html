<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AurumShield ‚Äî Technical Platform Overview</title>
    <meta
      name="description"
      content="Comprehensive technical overview of the AurumShield sovereign gold-trading platform for investor due diligence."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=Source+Serif+4:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #0b1220;
        --s1: #0f1a2b;
        --s2: #13233a;
        --s3: #182b46;
        --border: #243653;
        --text: #e7ecf4;
        --text-m: #aab6c8;
        --text-f: #7f8ca3;
        --gold: #c6a86b;
        --gold-h: #d3b77d;
        --success: #3fae7a;
        --warning: #d0a85c;
        --danger: #d16a5d;
        --info: #5a8ccb;
        --r: 10px;
        --sans: "IBM Plex Sans", system-ui, sans-serif;
        --serif: "Source Serif 4", Georgia, serif;
        --mono:
          ui-monospace, "Cascadia Code", "Source Code Pro", Consolas, monospace;
      }
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        border-color: var(--border);
      }
      body {
        background: var(--bg);
        color: var(--text);
        font-family: var(--sans);
        font-size: 0.9375rem;
        line-height: 1.65;
        -webkit-font-smoothing: antialiased;
      }
      .wrap {
        max-width: 1120px;
        margin: 0 auto;
        padding: 2rem 1.5rem 4rem;
      }
      h1,
      h2,
      h3 {
        font-family: var(--serif);
        letter-spacing: -0.02em;
        color: var(--text);
      }
      h1 {
        font-size: 2rem;
        line-height: 2.4rem;
        font-weight: 700;
        margin-bottom: 0.75rem;
      }
      h2 {
        font-size: 1.5rem;
        line-height: 2rem;
        font-weight: 600;
        margin: 3rem 0 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--gold);
      }
      h3 {
        font-size: 1.15rem;
        line-height: 1.6rem;
        font-weight: 600;
        margin: 1.75rem 0 0.75rem;
        font-family: var(--sans);
      }
      p {
        margin-bottom: 1rem;
        color: var(--text-m);
      }
      strong {
        color: var(--text);
      }
      a {
        color: var(--gold);
      }
      .gold {
        color: var(--gold);
      }
      .mono {
        font-family: var(--mono);
        font-size: 0.8125rem;
      }
      .label {
        font-family: var(--sans);
        font-size: 0.6875rem;
        font-weight: 700;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        color: var(--text-f);
      }
      /* Header */
      .hdr {
        text-align: center;
        padding: 3rem 0 2rem;
        border-bottom: 1px solid var(--border);
      }
      .hdr .badge {
        display: inline-block;
        background: var(--s2);
        border: 1px solid var(--gold);
        color: var(--gold);
        font-size: 0.7rem;
        font-weight: 700;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        padding: 0.3rem 0.9rem;
        border-radius: 99px;
        margin-bottom: 1rem;
      }
      .hdr p.sub {
        font-size: 1.05rem;
        color: var(--text-m);
        max-width: 720px;
        margin: 0 auto;
      }
      /* Cards */
      .card {
        background: var(--s1);
        border: 1px solid var(--border);
        border-radius: var(--r);
        padding: 1.25rem 1.5rem;
        margin-bottom: 1rem;
        transition: box-shadow 0.12s;
      }
      .card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.35);
      }
      .card h3 {
        margin-top: 0;
      }
      /* KPI Row */
      .kpi-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
        margin: 1.5rem 0;
      }
      .kpi {
        background: var(--s2);
        border: 1px solid var(--border);
        border-radius: var(--r);
        padding: 1rem 1.25rem;
        text-align: center;
      }
      .kpi .val {
        font-family: var(--serif);
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gold);
      }
      .kpi .lbl {
        font-size: 0.7rem;
        font-weight: 600;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        color: var(--text-f);
        margin-top: 0.25rem;
      }
      /* Pipeline */
      .pipeline {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1rem;
        margin: 1.5rem 0;
      }
      .step {
        background: var(--s1);
        border: 1px solid var(--border);
        border-radius: var(--r);
        padding: 1.25rem;
        position: relative;
        overflow: hidden;
      }
      .step::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: var(--gold);
      }
      .step .num {
        font-family: var(--serif);
        font-size: 1.6rem;
        font-weight: 700;
        color: var(--gold);
        opacity: 0.35;
        position: absolute;
        top: 0.5rem;
        right: 0.75rem;
      }
      .step h4 {
        font-family: var(--sans);
        font-size: 0.85rem;
        font-weight: 700;
        color: var(--text);
        margin-bottom: 0.4rem;
        text-transform: uppercase;
        letter-spacing: 0.03em;
      }
      .step p {
        font-size: 0.8125rem;
        line-height: 1.45;
        color: var(--text-m);
        margin: 0;
      }
      .step .tag {
        display: inline-block;
        font-size: 0.65rem;
        font-weight: 700;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        padding: 0.15rem 0.5rem;
        border-radius: 4px;
        margin-top: 0.5rem;
      }
      .tag-auth {
        background: rgba(90, 140, 203, 0.15);
        color: var(--info);
      }
      .tag-kyc {
        background: rgba(63, 174, 122, 0.15);
        color: var(--success);
      }
      .tag-engine {
        background: rgba(208, 168, 92, 0.15);
        color: var(--warning);
      }
      .tag-settle {
        background: rgba(198, 168, 107, 0.15);
        color: var(--gold);
      }
      .tag-ship {
        background: rgba(209, 106, 93, 0.15);
        color: var(--danger);
      }
      /* Tables */
      table {
        width: 100%;
        border-collapse: collapse;
        margin: 1rem 0;
        font-size: 0.8125rem;
      }
      th,
      td {
        padding: 0.6rem 0.75rem;
        text-align: left;
        border-bottom: 1px solid var(--border);
      }
      th {
        background: var(--s2);
        font-weight: 600;
        font-size: 0.7rem;
        letter-spacing: 0.03em;
        text-transform: uppercase;
        color: var(--text-f);
      }
      td {
        color: var(--text-m);
        font-variant-numeric: tabular-nums;
      }
      tbody tr:nth-child(even) {
        background: rgba(19, 35, 58, 0.4);
      }
      .chk {
        color: var(--success);
      }
      .warn {
        color: var(--warning);
      }
      /* Grid */
      .g2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
      }
      @media (max-width: 768px) {
        .g2,
        .pipeline {
          grid-template-columns: 1fr;
        }
      }
      /* Section divider */
      .divider {
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--gold),
          transparent
        );
        margin: 3rem 0;
        opacity: 0.4;
      }
      /* Flow arrow */
      .flow-arrow {
        text-align: center;
        color: var(--gold);
        font-size: 1.5rem;
        margin: 0.5rem 0;
        opacity: 0.5;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- HEADER                                                         -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <header class="hdr">
        <div class="badge">Confidential ‚Äî Investor Due Diligence</div>
        <h1>AurumShield<span class="gold">.</span></h1>
        <p class="sub">
          Sovereign Financial Infrastructure for Institutional Gold Trading ‚Äî
          End-to-End Platform Technical Overview
        </p>
      </header>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- SECTION 1 ‚Äî EXECUTIVE SUMMARY                                  -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <h2>1. Executive Summary &amp; Platform Overview</h2>

      <p>
        AurumShield is a
        <strong>sovereign financial infrastructure platform</strong>
        purpose-built for secure, compliant institutional gold trading. The
        platform delivers a fully integrated digital experience ‚Äî from
        counterparty onboarding and identity verification through real-time
        marketplace operations, settlement execution, and physical delivery
        logistics ‚Äî within a single, auditable system.
      </p>

      <p>
        The platform implements
        <strong>clearinghouse-grade trade lifecycle management</strong> with
        formalized state machines governing every order and settlement
        transition. All operations are enforced through a deterministic policy
        engine that evaluates counterparty risk, capital adequacy, and
        compliance posture in real time before any transaction is authorized.
      </p>

      <p>
        AurumShield's architecture is designed around three core principles:
        <strong>fail-closed security</strong> (every protected operation
        requires DB-verified compliance approval),
        <strong>dual-rail settlement resilience</strong> (automatic failover
        between Modern Treasury Fedwire and Moov wallet-to-wallet rails), and
        <strong>forensic auditability</strong> (every state transition produces
        tamper-evident, SHA-256 hashed audit events).
      </p>

      <div class="kpi-row">
        <div class="kpi">
          <div class="val">25+</div>
          <div class="lbl">Core Engine Modules</div>
        </div>
        <div class="kpi">
          <div class="val">10</div>
          <div class="lbl">Database Migrations</div>
        </div>
        <div class="kpi">
          <div class="val">2</div>
          <div class="lbl">Settlement Rails</div>
        </div>
        <div class="kpi">
          <div class="val">5-Layer</div>
          <div class="lbl">RBAC Capability Ladder</div>
        </div>
        <div class="kpi">
          <div class="val">3-Tier</div>
          <div class="lbl">AWS Network Isolation</div>
        </div>
        <div class="kpi">
          <div class="val">SHA-256</div>
          <div class="lbl">Audit Hash Chain</div>
        </div>
      </div>

      <div class="divider"></div>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- SECTION 2 ‚Äî TRANSACTION LIFECYCLE                              -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <h2>2. The Lifecycle of a Transaction</h2>

      <p>
        Every gold transaction on AurumShield follows a strict, auditable
        pipeline from initial user registration through final delivery
        confirmation. Each stage is governed by formalized state machines
        (<code>state-machine.ts</code>), role-based access controls
        (<code>authz.ts</code>), and capital adequacy checks
        (<code>capital-controls.ts</code>) ‚Äî ensuring no step can be bypassed or
        executed out of order.
      </p>

      <div class="pipeline">
        <div class="step">
          <div class="num">01</div>
          <h4>Account Creation</h4>
          <p>
            Users register via <strong>Clerk</strong> with passkey-based
            authentication. The middleware (<code>middleware.ts</code>) enforces
            session protection on all non-public routes. Device fingerprinting
            via <strong>Fingerprint.com</strong> establishes a trust baseline ‚Äî
            bot detection, velocity checks, and confidence scoring are applied
            in real time.
          </p>
          <span class="tag tag-auth">Clerk ¬∑ Fingerprint.com</span>
        </div>

        <div class="step">
          <div class="num">02</div>
          <h4>Identity Verification (KYC/KYB)</h4>
          <p>
            The verification engine (<code>verification-engine.ts</code>)
            orchestrates a multi-step identity perimeter.
            <strong>KYC track:</strong> email/phone confirmation, government ID
            capture via <strong>Persona</strong>, biometric liveness check, and
            sanctions/PEP screening via <strong>OpenSanctions</strong>.
            <strong>KYB track:</strong> business registration verification, UBO
            declaration, proof of address, and source of funds analysis. Each
            step transitions through PENDING ‚Üí PROCESSING ‚Üí PASSED/FAILED via
            async webhook callbacks.
          </p>
          <span class="tag tag-kyc">Persona ¬∑ OpenSanctions ¬∑ Diro</span>
        </div>

        <div class="step">
          <div class="num">03</div>
          <h4>Compliance Case Approval</h4>
          <p>
            The compliance case model (<code>compliance/models.ts</code>)
            creates a formal case that progresses through a confined state
            machine: OPEN ‚Üí PENDING_USER ‚Üí PENDING_PROVIDER ‚Üí UNDER_REVIEW ‚Üí
            APPROVED. Only APPROVED cases unlock protected capabilities. The
            <strong>capability ladder</strong> gates access progressively:
            BROWSE ‚Üí QUOTE ‚Üí LOCK_PRICE ‚Üí EXECUTE_PURCHASE ‚Üí SETTLE.
          </p>
          <span class="tag tag-kyc">Fail-Closed Enforcement</span>
        </div>

        <div class="step">
          <div class="num">04</div>
          <h4>Marketplace &amp; Price Discovery</h4>
          <p>
            The marketplace engine (<code>marketplace-engine.ts</code>) lists
            LBMA Good Delivery-verified gold from validated sellers. Every
            listing requires three evidence types:
            <strong>Assay Report</strong>, <strong>Chain of Custody</strong>,
            and <strong>Seller Attestation</strong>. The refiner is verified
            against the LBMA Good Delivery List (<code>lbma-service.ts</code>)
            containing 34+ accredited refiners worldwide.
          </p>
          <span class="tag tag-engine">LBMA Verification ¬∑ Evidence Gate</span>
        </div>

        <div class="step">
          <div class="num">05</div>
          <h4>Price Lock &amp; Atomic Checkout</h4>
          <p>
            The policy engine (<code>policy-engine.ts</code>) computes a
            <strong>Transaction Risk Index (TRI)</strong> ‚Äî a weighted composite
            of counterparty risk, corridor risk, amount concentration, and
            counterparty status. Capital validation ensures post-transaction ECR
            and hardstop utilization remain within thresholds. The atomic
            checkout (<code>executeAtomicCheckout</code>) collapses reserve +
            convert into a single state transition with inventory invariant
            enforcement ‚Äî mirroring a SERIALIZABLE database transaction.
          </p>
          <span class="tag tag-engine">TRI Scoring ¬∑ Inventory Invariants</span>
        </div>

        <div class="step">
          <div class="num">06</div>
          <h4>Settlement &amp; DvP Execution</h4>
          <p>
            Settlement opens via <code>settlement-engine.ts</code> with
            double-entry clearing journals (RSK-006) ‚Äî every fund movement
            produces a balanced journal where debits equal credits. The
            dual-rail router (<code>settlement-rail.ts</code>) selects between
            <strong>Modern Treasury</strong> (Fedwire/RTGS for enterprise) and
            <strong>Moov</strong> (wallet-to-wallet for standard), with
            automatic fallback. Each payout carries a deterministic
            <strong>SHA-256 idempotency key</strong> to prevent double-spend.
          </p>
          <span class="tag tag-settle">Dual-Rail DvP ¬∑ Idempotent</span>
        </div>

        <div class="step">
          <div class="num">07</div>
          <h4>Secure Logistics &amp; Tracking</h4>
          <p>
            The EasyPost adapter (<code>easypost-adapter.ts</code>) quotes and
            books <strong>USPS Registered Mail</strong> shipments from the
            AurumShield vault facility (New York). Gold parcels are dimensioned
            using industry-standard density calculations. For high-value
            shipments, <strong>Brink's</strong> armored transport is available.
            Full tracking events ‚Äî pickup, in-transit, delivered ‚Äî are streamed
            back into the settlement lifecycle.
          </p>
          <span class="tag tag-ship">EasyPost ¬∑ USPS ¬∑ Brink's</span>
        </div>

        <div class="step">
          <div class="num">08</div>
          <h4>Delivery Confirmation &amp; Certificate</h4>
          <p>
            Upon confirmed delivery, the certificate engine
            (<code>certificate-engine.ts</code>) issues a
            <strong>Gold Clearing Certificate</strong> (format:
            AS-GC-YYYYMMDD-&lt;8HEX&gt;-&lt;SEQ&gt;). The certificate payload is
            canonically serialized and signed with
            <strong>SHA-256</strong> (with AWS KMS ECDSA signing in production).
            Certificates are idempotent ‚Äî one per settlement ‚Äî and include full
            economic context: buyer/seller LEIs, asset details, fee breakdown,
            and settlement rail used.
          </p>
          <span class="tag tag-settle">SHA-256 Signed ¬∑ KMS ECDSA</span>
        </div>
      </div>

      <h3>Trade State Machine</h3>
      <p>
        Every order transitions through a strict state machine defined in
        <code>state-machine.ts</code>. Only authorized roles can trigger each
        transition, and illegal transitions throw forensic
        <code>IllegalStateTransitionError</code> events with full actor/entity
        context.
      </p>

      <div class="card" style="overflow-x: auto">
        <table>
          <thead>
            <tr>
              <th>State</th>
              <th>Allowed Transitions</th>
              <th>Authorized Roles</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>PENDING_ALLOCATION</code></td>
              <td>‚Üí PENDING_VERIFICATION, CANCELLED</td>
              <td>system, buyer</td>
            </tr>
            <tr>
              <td><code>PENDING_VERIFICATION</code></td>
              <td>‚Üí LOCKED_UNSETTLED, REJECTED_COMPLIANCE, CANCELLED</td>
              <td>system, compliance_officer</td>
            </tr>
            <tr>
              <td><code>LOCKED_UNSETTLED</code></td>
              <td>‚Üí SETTLEMENT_PENDING, CANCELLED</td>
              <td>system, treasury_admin</td>
            </tr>
            <tr>
              <td><code>SETTLEMENT_PENDING</code></td>
              <td>‚Üí SETTLED, FAILED</td>
              <td>system, treasury_admin</td>
            </tr>
            <tr>
              <td><code>SETTLED</code></td>
              <td>‚Äî (terminal)</td>
              <td>‚Äî</td>
            </tr>
            <tr>
              <td><code>REJECTED_COMPLIANCE</code></td>
              <td>‚Äî (terminal)</td>
              <td>‚Äî</td>
            </tr>
            <tr>
              <td><code>CANCELLED</code></td>
              <td>‚Äî (terminal)</td>
              <td>‚Äî</td>
            </tr>
            <tr>
              <td><code>FAILED</code></td>
              <td>‚Äî (terminal)</td>
              <td>‚Äî</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="divider"></div>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- SECTION 3 ‚Äî SECURITY ARCHITECTURE & COMPLIANCE MAPPING         -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <h2>3. Fortified Security Architecture &amp; Compliance Mapping</h2>

      <p>AurumShield implements a <strong>defense-in-depth</strong> security architecture where every layer ‚Äî from network topology to application logic ‚Äî enforces the principle of least privilege. The platform operates under a <strong>fail-closed</strong> security model: any ambiguity in authorization state results in denial, never approval.</p>

      <div class="g2">
        <div class="card">
          <h3>üîê Role-Based Access Control</h3>
          <p>Implemented in <code>authz.ts</code>, the authorization system defines a <strong>5-level capability ladder</strong> that maps KYC verification status to permitted operations:</p>
          <p><strong>BROWSE ‚Üí QUOTE ‚Üí LOCK_PRICE ‚Üí EXECUTE_PURCHASE ‚Üí SETTLE</strong></p>
          <p>Each capability implies all previous capabilities. Protected capabilities (LOCK_PRICE+) <strong>require a database-verified APPROVED compliance case</strong>. If the DB is unreachable, a 500 error is thrown ‚Äî the system never degrades to permissive. Six distinct roles govern settlement operations: <strong>buyer, seller, admin, treasury, compliance, vault_ops</strong>.</p>
        </div>

        <div class="card">
          <h3>üõ°Ô∏è Step-Up Re-Verification</h3>
          <p>High-value, irreversible operations (LOCK_PRICE, EXECUTE_PURCHASE, SETTLE) trigger <strong>step-up authentication</strong> via Clerk's reverification mechanism. Sessions older than <strong>5 minutes</strong> (300,000ms) require the user to re-authenticate before proceeding. This is enforced server-side by <code>requireReverification()</code>, preventing session hijacking from being exploited for financial operations.</p>
        </div>

        <div class="card">
          <h3>üìã Forensic Audit Logging</h3>
          <p>The audit logger (<code>audit-logger.ts</code>) produces <strong>append-only, structured JSON events</strong> written to stdout for CloudWatch/Datadog capture. Each event carries a <strong>deterministic SHA-256 event ID</strong> computed from timestamp + event name + payload ‚Äî ensuring the same event cannot be emitted twice and providing tamper-evident verification. Events include: <code>settlement_fallback_initiated</code>, <code>compliance_block_triggered</code>, <code>order_created</code> (with policy snapshot hash), <code>settlement_payout_confirmed</code>. Policy snapshots are SHA-256 hashed at order creation ‚Äî any later tampering is detectable.</p>
        </div>

        <div class="card">
          <h3>üîë Encryption Protocols</h3>
          <p><strong>At Rest:</strong> RDS PostgreSQL 15 with <code>storage_encrypted = true</code> (AES-256 via AWS KMS). Database credentials auto-managed by RDS and stored in AWS Secrets Manager ‚Äî never in Terraform state or environment variables. S3 document storage uses server-side encryption.</p>
          <p><strong>In Transit:</strong> All external traffic terminates at AWS ALB with ACM-provisioned TLS certificates. Webhook payloads from Modern Treasury are verified using <strong>HMAC-SHA256 with timing-safe comparison</strong> (<code>webhook-verify.ts</code>) to prevent timing attacks. Clearing certificates signed with <strong>AWS KMS ECDSA</strong> for non-repudiation.</p>
        </div>

        <div class="card">
          <h3>üåê Network Security</h3>
          <p>The infrastructure implements <strong>three-tier Security Group isolation</strong> defined in Terraform:</p>
          <p><strong>ALB SG:</strong> 80/443 inbound from 0.0.0.0/0 (public internet)<br/>
          <strong>App SG:</strong> Port 3000 inbound <em>from ALB SG only</em><br/>
          <strong>DB SG:</strong> Port 5432 inbound <em>from App SG only</em></p>
          <p>ECS tasks run in <strong>private subnets with no public IP</strong>. Outbound routes through NAT Gateway. Database is <strong>not publicly accessible</strong>. This ensures <strong>zero direct public access</strong> to containers or database.</p>
        </div>

        <div class="card">
          <h3>‚ö° Capital Controls &amp; Breach Monitoring</h3>
          <p>The capital controls engine evaluates real-time capital snapshots and enforces <strong>5 escalating control modes</strong>:</p>
          <p><strong>NORMAL ‚Üí THROTTLE_RESERVATIONS ‚Üí FREEZE_CONVERSIONS ‚Üí FREEZE_MARKETPLACE ‚Üí EMERGENCY_HALT</strong></p>
          <p>The breach monitor generates deterministic, idempotent breach events when ECR ratios or hardstop utilization exceed thresholds. Each breach carries a <strong>FNV-1a hashed ID</strong> scoped to minute-buckets for deduplication. CRITICAL breaches (‚â•95% hardstop) trigger immediate governance alerts.</p>
        </div>
      </div>

      <h3>Compliance Framework Cross-Reference</h3>
      <div class="card" style="overflow-x: auto">
        <table>
          <thead><tr><th>Framework</th><th>Requirement</th><th>Implementation</th><th>Source</th></tr></thead>
          <tbody>
            <tr><td rowspan="3"><strong>KYC / AML</strong></td><td>Identity Verification</td><td>Persona: government ID, biometric liveness, multi-step workflow</td><td><code>kyc-adapters.ts</code></td></tr>
            <tr><td>Sanctions Screening</td><td>OpenSanctions: OFAC SDN, EU, UN, UK HMT, DFAT watchlists</td><td><code>kyc-adapters.ts</code></td></tr>
            <tr><td>UBO Declaration</td><td>Company/individual bifurcation, source of funds analysis</td><td><code>verification-engine.ts</code></td></tr>
            <tr><td rowspan="3"><strong>SOC 2</strong></td><td>Audit Trail</td><td>Append-only SHA-256 hashed events, deterministic IDs, SIEM-ready JSON</td><td><code>audit-logger.ts</code></td></tr>
            <tr><td>Access Control</td><td>5-level RBAC, 6 roles, fail-closed enforcement, step-up re-verification</td><td><code>authz.ts</code></td></tr>
            <tr><td>Change Management</td><td>Formalized state machines, illegal transition forensic logging</td><td><code>state-machine.ts</code></td></tr>
            <tr><td rowspan="3"><strong>PCI-DSS</strong></td><td>Payment Routing</td><td>Dual-rail via PCI-compliant processors (Modern Treasury, Moov) ‚Äî no raw card data</td><td><code>settlement-rail.ts</code></td></tr>
            <tr><td>Idempotent Txns</td><td>SHA-256 idempotency keys, ON CONFLICT dedup, transfer status polling</td><td><code>settlement-rail.ts</code></td></tr>
            <tr><td>Webhook Integrity</td><td>HMAC-SHA256 + timing-safe comparison for all inbound webhooks</td><td><code>webhook-verify.ts</code></td></tr>
            <tr><td rowspan="2"><strong>GDPR / CCPA</strong></td><td>Data Minimization</td><td>PII managed by Clerk; app stores only opaque user IDs, not raw PII</td><td><code>middleware.ts</code></td></tr>
            <tr><td>At-Rest Protection</td><td>RDS AES-256, Secrets Manager for credentials, S3 server-side encryption</td><td><code>rds.tf</code></td></tr>
            <tr><td rowspan="2"><strong>LBMA</strong></td><td>Refiner Verification</td><td>Embedded 34+ refiner cache with fuzzy name matching</td><td><code>lbma-service.ts</code></td></tr>
            <tr><td>Evidence Gate</td><td>3 mandatory evidence types per listing: Assay, Chain of Custody, Attestation</td><td><code>marketplace-engine.ts</code></td></tr>
          </tbody>
        </table>
      </div>

      <div class="divider"></div>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <!-- SECTION 4 ‚Äî TECHNICAL STACK & INFRASTRUCTURE                   -->
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <h2>4. Technical Stack &amp; Infrastructure</h2>

      <div class="g2">
        <div class="card">
          <h3>Frontend</h3>
          <table>
            <tr><td><strong>Framework</strong></td><td>Next.js 16.1.6 (App Router)</td></tr>
            <tr><td><strong>Runtime</strong></td><td>React 19.2.3 with Server Components</td></tr>
            <tr><td><strong>Styling</strong></td><td>Tailwind CSS v4, custom design tokens</td></tr>
            <tr><td><strong>UI Primitives</strong></td><td>Radix UI (Dialog, Dropdown, Tooltip, Popover, Switch)</td></tr>
            <tr><td><strong>Forms</strong></td><td>React Hook Form + Zod v4 schema validation</td></tr>
            <tr><td><strong>Data Fetching</strong></td><td>TanStack React Query v5</td></tr>
            <tr><td><strong>Animation</strong></td><td>Framer Motion v12</td></tr>
            <tr><td><strong>Typography</strong></td><td>IBM Plex Sans + Source Serif 4</td></tr>
            <tr><td><strong>Auth UI</strong></td><td>Clerk React (SignIn, SignUp, passkeys)</td></tr>
          </table>
        </div>

        <div class="card">
          <h3>Backend &amp; Data</h3>
          <table>
            <tr><td><strong>Server Logic</strong></td><td>Next.js Server Actions + API Routes</td></tr>
            <tr><td><strong>Database</strong></td><td>PostgreSQL 15 (RDS, gp3, encrypted)</td></tr>
            <tr><td><strong>DB Client</strong></td><td>node-postgres (pg v8), raw SQL migrations</td></tr>
            <tr><td><strong>Schema</strong></td><td>10 sequential migrations (buyer_journey ‚Üí risk_parameters)</td></tr>
            <tr><td><strong>Auth</strong></td><td>Clerk v6 (passkey-first, sessions)</td></tr>
            <tr><td><strong>KYC</strong></td><td>Persona v5 (ID verification, liveness)</td></tr>
            <tr><td><strong>AML</strong></td><td>OpenSanctions (OFAC, EU, UN, UK, AU)</td></tr>
            <tr><td><strong>Device Trust</strong></td><td>Fingerprint.com Pro (bot detection, velocity)</td></tr>
            <tr><td><strong>Docs</strong></td><td>AWS Textract (OCR verification)</td></tr>
            <tr><td><strong>Email</strong></td><td>Resend (transactional email)</td></tr>
          </table>
        </div>

        <div class="card">
          <h3>Settlement &amp; Payments</h3>
          <table>
            <tr><td><strong>Primary Rail</strong></td><td>Modern Treasury v3 (Fedwire / RTGS)</td></tr>
            <tr><td><strong>Secondary Rail</strong></td><td>Moov (wallet-to-wallet, OAuth2)</td></tr>
            <tr><td><strong>Rail Selection</strong></td><td>Auto: Moov default, MT for ‚â•$250K</td></tr>
            <tr><td><strong>Fallback</strong></td><td>Automatic with finality check</td></tr>
            <tr><td><strong>Idempotency</strong></td><td>SHA-256: settlement_id|payee_id|amount|action</td></tr>
            <tr><td><strong>Clearing</strong></td><td>Double-entry balanced debit/credit journals</td></tr>
            <tr><td><strong>Certificates</strong></td><td>SHA-256 + optional KMS ECDSA signing</td></tr>
          </table>
        </div>

        <div class="card">
          <h3>Logistics</h3>
          <table>
            <tr><td><strong>Standard</strong></td><td>EasyPost ‚Üí USPS Registered Mail</td></tr>
            <tr><td><strong>High-Value</strong></td><td>Brink's armored transport</td></tr>
            <tr><td><strong>Parcels</strong></td><td>Computed from gold density (19.32 g/cm¬≥)</td></tr>
            <tr><td><strong>Origin</strong></td><td>AurumShield Vault, 1 Federal Reserve Plz, NY</td></tr>
            <tr><td><strong>Tracking</strong></td><td>Real-time events ‚Üí settlement lifecycle</td></tr>
          </table>
        </div>
      </div>

      <h3>Infrastructure Architecture (AWS)</h3>
      <div class="card" style="overflow-x: auto">
        <table>
          <thead><tr><th>Component</th><th>Service</th><th>Configuration</th></tr></thead>
          <tbody>
            <tr><td><strong>Compute</strong></td><td>ECS Fargate</td><td>2 tasks (512 CPU / 1024 MB), private subnets, rolling deploys</td></tr>
            <tr><td><strong>Registry</strong></td><td>ECR</td><td>Multi-stage Docker (Node 20 Alpine), non-root user</td></tr>
            <tr><td><strong>Load Balancer</strong></td><td>ALB</td><td>HTTPS with ACM TLS, HTTP‚ÜíHTTPS redirect</td></tr>
            <tr><td><strong>Database</strong></td><td>RDS PostgreSQL 15</td><td>db.t3.micro, gp3 encrypted, private, 7-day backups</td></tr>
            <tr><td><strong>Secrets</strong></td><td>Secrets Manager</td><td>RDS auto-managed password ‚Äî never in tfstate</td></tr>
            <tr><td><strong>Storage</strong></td><td>S3</td><td>Document storage with server-side encryption</td></tr>
            <tr><td><strong>Networking</strong></td><td>VPC 10.0.0.0/16</td><td>2 AZs, 2 public + 2 private subnets, NAT Gateway</td></tr>
            <tr><td><strong>Monitoring</strong></td><td>CloudWatch</td><td>Structured JSON audit ingestion</td></tr>
            <tr><td><strong>DNS</strong></td><td>Route 53</td><td>Hosted zone with ALB alias</td></tr>
            <tr><td><strong>CI/CD</strong></td><td>GitHub Actions</td><td>Build ‚Üí ECR push ‚Üí ECS blue-green deploy</td></tr>
          </tbody>
        </table>
      </div>

      <h3>API &amp; Webhook Security</h3>
      <div class="card">
        <p>All API routes are protected by Clerk middleware. Webhook endpoints (<code>/api/webhooks/*</code>) are exempted from session auth but enforce <strong>payload-level cryptographic verification</strong>:</p>
        <p><strong>Modern Treasury:</strong> HMAC-SHA256 in <code>X-Signature</code> header, timing-safe comparison via <code>timingSafeEqual()</code>.<br/>
        <strong>Persona:</strong> Idempotent processing via <code>webhookId</code> tracking ‚Äî duplicates safely ignored.<br/>
        <strong>Clerk:</strong> Svix-signed payloads verified by the Clerk SDK's built-in webhook verification.</p>
      </div>

      <div class="divider"></div>

      <footer style="text-align: center; padding: 2rem 0; border-top: 1px solid var(--border)">
        <p class="label" style="margin-bottom: 0.25rem">AurumShield ‚Äî Sovereign Financial Infrastructure</p>
        <p style="font-size: 0.75rem; color: var(--text-f); margin: 0">Document generated from codebase analysis ‚Äî February 2026. Confidential.</p>
      </footer>
    </div>
  </body>
</html>
